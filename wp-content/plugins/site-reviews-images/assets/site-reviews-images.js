!function(){"use strict";var e,t={485:function(){var e="site-reviews-images";const t=e=>{let i=Array.isArray(e)?[]:{};for(let o in e){let a=e[o],s={}.toString.call(a).slice(8,-1);i[o]="Array"==s||"Object"==s?t(a):"Date"==s?new Date(a.getTime()):a}return i},i=GLSR.Utils.dom,o=(e,t,o)=>i("a",{class:`glsr-dz-button glsr-dz-${e}`,tabindex:0,href:"javascript:undefined;",title:t,[`data-dz-${e}`]:""},o),a=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return i("div",...t)},s=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return i("span",...t)},n=(e,t,o,a)=>i("line",{x1:e,y1:t,x2:o,y2:a}),r=(e,t)=>i("stop",{offset:e,"stop-color":t}),d=GLSR.addons[e].text,l=GLSR.addons[e],p="glsr.images",c={acceptedFiles:l.acceptedfiles,addRemoveLinks:!1,dictCancelUpload:l.text.cancelUpload,dictCancelUploadConfirmation:l.text.cancelUploadConfirmation,dictFallbackMessage:l.text.fallbackMessage,dictFallbackText:l.text.fallbackText,dictFileTooBig:l.text.fileTooBig,dictInvalidFileType:l.text.invalidFileType,dictMaxFilesExceeded:l.text.maxFilesExceeded,dictRemoveFileConfirmation:l.text.removeFileConfirmation,dictResponseError:l.text.responseError,dictUploadCanceled:l.text.uploadCanceled,maxFiles:l.maxfiles,maxFilesize:l.maxfilesize,previewTemplate:(()=>{const e=s("glsr-dz-progress",s({"data-dz-uploadprogress":""})),t=s("glsr-dz-overlay",i("svg",{viewBox:"0 0 500 250",preserveAspectRatio:"none"},i("rect",{style:"height:100%;width:100%;",x:0,width:500,height:250,fill:"currentColor",mask:"url(#glsr-svg-overlay-mask)"}))),a=i("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round"},n(18,6,6,18),n(6,6,18,18)),r=i("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2.5},i("path",{d:"M12 5C12 5 12.0610767 2 7 2M11.9999661 5C11.9999661 5 11.9389233 2 17 2M7 22C12.1495319 22 11.9995455 19 11.9995455 19M17 22C11.8504681 22 12.0004545 19 12.0004545 19"}),n(12,4,12,20));const l=s("glsr-dz-buttons",o("remove",d.removeImage,a),o("edit",d.editCaption,r)),p=s("glsr-dz-details",l,s("glsr-dz-filename",s({"data-dz-name":""})),s("glsr-dz-caption",s({"data-dz-caption":""})),s("glsr-dz-error-message",s({"data-dz-errormessage":""}))),c=s("glsr-dz-image",i("img",{"data-dz-thumbnail":"","data-no-lazy":""}));return s("glsr-dz-preview",e,t,p,c)})().outerHTML,resizeHeight:1920,resizeMethod:"contain",resizeWidth:1920,thumbnailHeight:300,thumbnailMethod:"contain",thumbnailWidth:300,url:GLSR.ajaxurl};class g{constructor(e){this.images=[],this.isDuplicateImage=!1,this.isFormSubmitted=!1,this.dropzone=new Dropzone(e,c),this.dropzone.on("addedfile",this.onAddedFile.bind(this)),this.dropzone.on("addedfile",this.handleEditFile.bind(this)),this.dropzone.on("removedfile",this.onRemovedFile.bind(this)),this.dropzone.on("sending",this.onBeforeSending.bind(this)),this.dropzone.on("success",this.onUploadSuccess.bind(this)),this.dropzone.on("error",this.onError.bind(this)),this.dropzone.on("complete",this.onComplete.bind(this)),this.dropzone.on("queuecomplete",this.onQueueUploadComplete.bind(this)),this.dropzone.on("deleted-image",this.onDeletedImage.bind(this)),this.dropzone.on("deleted-temporary-image",this.onDeletedImage.bind(this)),this.storedEvents={},GLSR.Event.on("site-reviews/form/handle",this.onAfterSubmission.bind(this)),this.populateImages(),document.querySelector(".glsr-svg-sprite")||document.body.appendChild((()=>{const e=i("radialGradient",{id:"glsr-svg-overlay-radial-gradient",cx:.5,cy:1.25,r:1.15},r("50%","#000000"),r("56%","#0a0a0a"),r("63%","#262626"),r("69%","#4f4f4f"),r("75%","#808080"),r("81%","#b1b1b1"),r("88%","#dadada"),r("94%","#f6f6f6"),r("100%","#ffffff")),t=i("mask",{id:"glsr-svg-overlay-mask"},i("rect",{x:0,y:0,width:500,height:250,fill:"url(#glsr-svg-overlay-radial-gradient)"}));return i("svg",{class:"glsr-svg-sprite",style:"position:absolute!important;width:0!important;height:0!important;"},e,t)})())}appendToFormData(e,t,i){return e.append(GLSR.nameprefix+"["+t+"]",i),e}deleteImage(e){let t=this.normalizeFormData(new FormData);this.appendToFormData(t,"method","delete"),this.appendToFormData(t,"id",e.id),this.toggleButtonState(!0),GLSR.ajax.post(t,(e=>{this.dropzone.emit("deleted-image",e),this.toggleButtonState(!1)}))}deleteTemporaryImage(e){let t=this.normalizeFormData(new FormData);this.appendToFormData(t,"file",e.file),this.appendToFormData(t,"method","purge"),this.appendToFormData(t,"name",e.name),this.appendToFormData(t,"url",e.dataURL),this.toggleButtonState(!0),GLSR.ajax.post(t,(e=>{this.dropzone.emit("deleted-temporary-image",e),this.toggleButtonState(!1)}))}findIndexIn(e,t){for(let i=0,o=e.length;i<o;i++)if(t.name===e[i].name&&t.size===e[i].size&&t.lastModified===e[i].lastModified)return i;return!1}generateThumbnailFromUrl(e){this.dropzone.emit("thumbnail",e,e.dataURL)}handleEditFile(e){const t=e.previewElement.querySelector("[data-dz-edit]");t&&t.addEventListener("click",this.onEditFile.bind(this,e))}insertCaption(e){const t=e.previewElement.querySelector("[data-dz-caption]");if(t){t.textContent=e.caption;let i=this.findIndexIn(this.images,e);!1!==i&&(this.images[i].caption=e.caption),this.loadImagesInForm(),localStorage.setItem(p,JSON.stringify(this.images))}}isDuplicate(e){let i=t(this.dropzone.files);return i.pop(),!1!==this.findIndexIn(i,e)}loadImages(){for(let e in this.images){if(!this.images.hasOwnProperty(e))continue;let t=this.images[e];this.dropzone.emit("addedfile",t),this.dropzone.createThumbnailFromUrl(t,c.thumbnailWidth,c.thumbnailHeight,c.thumbnailMethod,!0,this.generateThumbnailFromUrl.bind(this,t)),this.dropzone.emit("complete",t),this.dropzone.files.push(t),this.dropzone._callbacks.success[0](t),this.onAddedFile(t)}this.loadImagesInForm()}loadImagesInForm(){let e=[];this.images.forEach((t=>{e.push({caption:t.caption,file:t.file,id:t.id,url:t.dataURL})})),this.dropzone.element.querySelector("[data-dz-images]").value=JSON.stringify(e)}normalizeFormData(e){return e.append("action",GLSR.action),e.append("_ajax_request",!0),this.appendToFormData(e,"_action",l.action),this.appendToFormData(e,"_nonce",l.nonce),e}onAddedFile(e){this.isFormSubmitted=!1,this.isDuplicateImage=this.isDuplicate(e),this.isDuplicateImage&&this.dropzone.removeFile(e)}onAfterSubmission(e){this.isFormSubmitted=!0,!0===e?.success&&this.resetImages()}onBeforeSending(e,t,i){this.normalizeFormData(i),this.appendToFormData(i,"method","upload"),this.toggleButtonState(!0)}onComplete(e){this.insertCaption(e),e.id&&e.previewElement.classList.add("dz-saved")}onDeletedImage(e){e&&(this.removeImage("file",e.file),localStorage.setItem(p,JSON.stringify(this.images)),this.loadImagesInForm())}onEditedFile(e,t){const i=t.querySelector("textarea").value;e.caption=i.replace(/\s+/g," ").trim(),this.insertCaption(e),document.removeEventListener("keydown",this.storedEvents.keydown),GLSR.Modal.close("glsr-modal-caption")}onEditFile(e,t){const o=(()=>{const e=i("textarea",{rows:4,placeholder:d.enterCaption}),t="btn btn-primary button wp-block-button__link glsr-dropzone-modal-",o=i("button",{type:"button",class:`${t}save`},d.save),s=i("button",{type:"button",class:`${t}close`,"data-glsr-close":""},d.cancel),n=a("wp-block-buttons",a("wp-block-button",o),a("wp-block-button",s));return a("glsr-dz-modal-caption",e,n)})();GLSR.Modal.open("glsr-modal-caption",{focus:!0,onOpen:i=>{i.dom.close.remove(),i.dom.close=null,i.root.classList.add("is-image-caption"),document.body.classList.contains("theme-twentytwentyone")&&i.root.classList.add("site"),o.querySelector("textarea").innerText=e.caption||"",i.content().innerHTML=o.outerHTML,i.content().querySelector(".glsr-dropzone-modal-save").addEventListener("click",(()=>{t.preventDefault(),this.onEditedFile(e,i.content())})),document.addEventListener("keydown",this.storedEvents.keydown)}})}onError(e,t){this.dropzone.removeFile(e);let i=document.createElement("div");i.classList.add("glsr-dz-error"),i.innerText=t,this.dropzone.element.appendChild(i),setTimeout((()=>{i.parentNode.removeChild(i)}),3e3)}onKeydown(e,t,i){13===i.keyCode&&this.onEditedFile(e,t)}onQueueUploadComplete(){this.toggleButtonState(!1)}onRemovedFile(e){if(!this.isDuplicateImage){if(e.id)this.deleteImage(e);else if(!this.isFormSubmitted)for(let t in this.images)if(this.images.hasOwnProperty(t)&&this.images[t].name===e.name){this.deleteTemporaryImage(this.images[t]);break}this.dropzone.files.length||this.resetImages()}}onUploadSuccess(e,t){if(e.id)return;let i={};for(let t in e)~["accepted","height","lastModified","name","processing","size","status","type","width"].indexOf(t)&&(i[t]=e[t]);i.caption="",i.dataURL=t.data.url,i.file=t.data.file,this.images.push(i),this.loadImagesInForm(),localStorage.setItem(p,JSON.stringify(this.images))}populateImages(){this.images=JSON.parse(localStorage.getItem(p))||[],this.images.length>=c.maxFiles&&this.dropzone.element.classList.add("dz-max-files-reached"),this.loadImages()}removeImage(e,t){let i=[],o=0;if(!Array.isArray(this.images))return i;for(let a in this.images)this.images.hasOwnProperty(a)&&this.images[a][e]!==t&&(i[o++]=this.images[a]);this.images=i}resetImages(){let e=this.dropzone.files;for(let t in e)e.hasOwnProperty(t)&&(e[t].id=null,this.dropzone.removeFile(e[t]));localStorage.removeItem(p),this.images=[],this.loadImagesInForm()}toggleButtonState(e){const t=this.dropzone.element.closest("form");if(!t)return;const i=t.querySelector(".glsr-button-text");i&&i.getAttribute("data-text")&&(i.parentNode.disabled=e,i.innerText=e?l.text.pleaseWait:i.getAttribute("data-text"))}}const m=[];var h={init:e=>{document.querySelectorAll(e||".glsr-dropzone").forEach((e=>{if(!e.dropzone)try{m.push(new g(e))}catch(e){console.error(e)}}));for(let e=0;e<m.length;e++)m[e]&&!m[e].dropzone.element.closest("body")&&m.splice(e,1);return m},dropzones:m};const u=GLSR.addons[e],f=GLSR.Utils.dom;let v,w,x=null,b=0;const y=e=>{const t=u.swiper.Components.Slides.getAt(u.swiper.index);e&&!w.content().querySelector(`.glsr[data-review_id="${e.review_id}"]`)&&(w.content().insertAdjacentHTML("beforeend",e.review),w.content().querySelectorAll('p[data-trigger="modal"]').forEach((e=>{e.dataset.trigger="expand"})),w.content().querySelectorAll('[data-expanded="false"]').forEach((e=>{e.dataset.expanded="true"}))),b=t.slide.dataset.index,w.content().querySelectorAll(".glsr[data-review_id]").forEach((e=>{e.style.display=e.dataset.review_id===t.slide.dataset.review_id?"block":"none"})),GLSR.Event.trigger("site-reviews/init")},S=(e,t,i)=>{if(0===t){const t=u.swiper.options.speed||0;u.swiper.options={speed:0},u.swiper.add(e.slides,1);let i=e.slides.length;e.has_prev||(u.swiper.remove(0),i--),u.swiper.go(i).options={speed:t}}else u.swiper.length===t+1&&(u.swiper.add(e.slides,t),e.has_next||u.swiper.remove(u.swiper.length-1))},z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};C(e),R("fetch-image-gallery",e,(e=>{u.storage.data=e.data,w.content().innerHTML=e.html,w.content().querySelectorAll("a.glsri-image").forEach((e=>e.addEventListener("click",I))),""===w.footer().innerHTML&&w.footer(e.pagination);const t=w.footer().querySelector("input"),i=w.footer().querySelector("button[data-next]"),o=w.footer().querySelector("button[data-prev]");O({input:t,next:i,prev:o,page:e.data.page,max:e.data.max_pages}),w.root.classList.remove("is-loading")}))},L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};D(e),R("fetch-image-review",e,(t=>{w.content().innerHTML=t.slider,F(t,e,{keyboard:"global",pagination:!1,speed:400}),y(t)}))},F=(e,t,i)=>{const o=_();w.content().innerHTML=e.slider,u.swiper=new Splide(w.content().querySelector(".splide"),i).mount(),e.has_prev&&e.slides.unshift(o),e.has_next&&e.slides.push(o),u.swiper.add(e.slides),e.images.forEach(((e,o)=>{e.index!==+t.index||+t.index<1||(u.swiper.options={speed:0},u.swiper.go(o+1).options={speed:i.speed||0})})),u.swiper.on("move",k),u.swiper.on("moved",T)},I=e=>{const t=e.currentTarget;e.preventDefault(),L({ID:t.dataset.id,index:t.dataset.index,review_id:t.dataset.review_id,total:u.storage.data.total})},E=e=>{e.preventDefault();const t=Math.ceil((+b+1)/u.storage.data.per_page)||1;z({page:t})},k=(e,t,i)=>{const o=u.swiper.Components.Slides,a=o.getAt(e),s=o.getAt(t);if(!a.slide.querySelector(".glsri-spinner"))return void y();let n=-1;0===e?n=+s.slide.dataset.index-1:o.getLength()===e+1&&(n=+s.slide.dataset.index+1),R("fetch-image-review",{index:n},(t=>{u.swiper.state.is(Splide.STATES.MOVING)?M(t):(S(t,e),y(t))}))},T=(e,t,i)=>{const o=u.swiper.Components.Slides,a=o.getAt(e),s=o.getAt(t);a.slide.dataset.review_id!==s.slide.dataset.review_id&&null!==x&&(S(x,i),y(x),M(null))},R=(e,t,i)=>{let o={};for(let e of Object.keys(v.dataset))"display"!==e&&(o[`${GLSR.nameprefix}[atts][${e}]`]=v.dataset[e]);for(let e of Object.keys(t))o[`${GLSR.nameprefix}[${e}]`]=t[e];o[`${GLSR.nameprefix}[_action]`]=e,w.root.classList.add("is-loading"),GLSR.ajax.post(o,((e,o)=>{if(o)return w.root.classList.remove("is-loading"),i(e,t);(e=>{const t=e.message||u.text.genericModalError;w.content(t,{class:`is-modal-error is-${e.code}-error`})})(e),console.error({data:t,response:e})}))},C=e=>{A("is-image-gallery"),w.content().innerHTML="<div></div>".repeat(12),w.header(u.text.imageGallery)},D=e=>{A("is-image-review"),w.header('<a href="#" tabindex="0">'+u.text.viewImageGallery+"</a>"),w.header().querySelector("a").addEventListener("click",E),u.swiper&&u.swiper.length||(w.content().innerHTML=_()),w.footer(""),b=+e.index},M=e=>{x=e},G=(e,t,i)=>{e.removeEventListener(t,i),e.addEventListener(t,i,!0)},A=e=>{e&&(w.root.className="glsr-modal is-open",w.root.classList.add(e),w.root.classList.add(e)),u.swiper&&u.swiper.destroy(),w.root.setAttribute("style",v.getAttribute("style")),w.content(""),w.header("")},O=e=>{const{input:t,max:i,next:o,page:a,prev:s}=e;t.value=a,o.setAttribute("disabled",""),s.setAttribute("disabled",""),o.dataset.page=Math.min(i,a+1),s.dataset.page=Math.max(1,a-1),a>1&&s.removeAttribute("disabled"),a<i&&o.removeAttribute("disabled"),G(o,"click",q.click),G(s,"click",q.click),G(t,"change",q.change)},_=()=>f("div",{class:"splide__slide"},f("div",{class:"glsri-spinner"},f("div"),f("div"),f("div"))).outerHTML,q={click:e=>{e.preventDefault();const t=+e.currentTarget.dataset.page;z({page:t})},change:GLSR.Utils.debounce((e=>{const t=Math.max(1,Math.min(+e.target.max,+e.target.value));z({page:t})}),400)};var U=()=>{GLSR.Modal.init("glsr-modal-gallery",{onOpen:e=>{b=0,w=e,v=w.trigger.closest(".glsr"),w.trigger.classList.contains("glsri-image")?L({ID:w.trigger.dataset.id,index:w.trigger.dataset.index,review_id:w.trigger.dataset.review_id}):z({page:1})}})};const j=GLSR.addons[e],B=GLSR.Utils.dom,H=()=>{U(),"modal"===j.modal&&GLSR.Modal.init("glsr-modal-image",{onOpen:e=>{e.content().appendChild(B("figure",B("img",{src:e.trigger.href,height:e.trigger.dataset.height,width:e.trigger.dataset.width}),e.trigger.dataset.caption&&B("figcaption",{},e.trigger.dataset.caption)))}})};j.Dropzone=h,j.storage={data:{}},GLSR.Event.on(e+"/init",(()=>{h.init(),H()})),GLSR.Event.on("site-reviews/modal/open",H),GLSR.Event.on("site-reviews/pagination/handle",H),GLSR.Event.on("site-reviews/pagination/popstate",(e=>{e.state&&e.state[`${GLSR.nameprefix}[_action]`]&&"undefined"!=typeof Spotlight&&Spotlight.close()})),GLSR.Event.on("site-reviews/init",(()=>{GLSR.Event.trigger(e+"/init")}))},385:function(){},619:function(){},249:function(){}},i={};function o(e){var a=i[e];if(void 0!==a)return a.exports;var s=i[e]={exports:{}};return t[e](s,s.exports,o),s.exports}o.m=t,e=[],o.O=function(t,i,a,s){if(!i){var n=1/0;for(p=0;p<e.length;p++){i=e[p][0],a=e[p][1],s=e[p][2];for(var r=!0,d=0;d<i.length;d++)(!1&s||n>=s)&&Object.keys(o.O).every((function(e){return o.O[e](i[d])}))?i.splice(d--,1):(r=!1,s<n&&(n=s));if(r){e.splice(p--,1);var l=a();void 0!==l&&(t=l)}}return t}s=s||0;for(var p=e.length;p>0&&e[p-1][2]>s;p--)e[p]=e[p-1];e[p]=[i,a,s]},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={904:0,353:0,740:0,555:0};o.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,s,n=i[0],r=i[1],d=i[2],l=0;if(n.some((function(t){return 0!==e[t]}))){for(a in r)o.o(r,a)&&(o.m[a]=r[a]);if(d)var p=d(o)}for(t&&t(i);l<n.length;l++)s=n[l],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(p)},i=self.webpackChunk=self.webpackChunk||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}(),o.O(void 0,[353,740,555],(function(){return o(485)})),o.O(void 0,[353,740,555],(function(){return o(385)})),o.O(void 0,[353,740,555],(function(){return o(619)}));var a=o.O(void 0,[353,740,555],(function(){return o(249)}));a=o.O(a)}();