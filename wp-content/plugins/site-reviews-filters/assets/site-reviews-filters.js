!function(){"use strict";var e,t={900:function(){const e=GLSR.addons["site-reviews-filters"],t="glsr-bar-active",r="glsr-hide",s=".glsr-filter-status a",i=".glsr-pagination",n=".glsr-reviews, [data-reviews]",o=".glsr-filter-status";var a=class{constructor(){let{bars:e,forms:t,id:r,inputs:s,widget:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:data;this.bars=e,this.events={change:this._onChange.bind(this),change_checkbox:this._onChangeCheckbox.bind(this),clear:this._onClear.bind(this),click:this._onClick.bind(this),popstate:this._onPopstate.bind(this),submit:this._onSubmit.bind(this)},this.forms=t,this.id=r,this.inputs=s,this.loading=!1,this.widget=i,this._syncFilters(Object.fromEntries(new URL(location.href).searchParams)),this.init()}destroy(){this._eventHandler("remove")}init(){this._eventHandler("add")}_applyFilters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._syncFilters(e),this._updateUrl(e)}_clearFilters(){this.forms.forEach((e=>e.reset())),this._removeStatus(),this._syncFilters({filter_by_rating:""}),this._updateUrl()}_data(){try{const t=JSON.parse(JSON.stringify(this.widget.dataset)),r={};for(var e of Object.keys(t)){let s;try{s=JSON.parse(t[e])}catch(r){s=t[e]}r[`${GLSR.nameprefix}[atts][${e}]`]=s}return r[`${GLSR.nameprefix}[_action]`]="fetch-filtered-reviews",r[`${GLSR.nameprefix}[schema]`]=!1,r[`${GLSR.nameprefix}[url]`]=location.href,r}catch(e){return console.error("Invalid Reviews config."),!1}}_eventHandler(e){const t=e+"EventListener";this.bars.forEach((e=>{e[t]("click",this.events.click)})),this.forms.forEach((e=>{e[t]("submit",this.events.submit),e.querySelectorAll("select").forEach((e=>{e[t]("change",this.events.change)}));const r=e.parentElement.querySelector(s);r&&r[t]("click",this.events.clear)})),this.inputs.forEach((e=>{e[t]("change",this.events.change_checkbox)})),window[t]("popstate",this.events.popstate)}_handleResponse(e,t,r){if(!r)return console.error(t),void location.reload();this.destroy(),this._insertResponse(t),this._loaded(),GLSR.Event.trigger("site-reviews/init")}_insertResponse(){let{pagination:e,reviews:t,status:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:response;const s=this.widget.querySelector(n);this._removePagination(),this._removeStatus(),this.forms.forEach((e=>{e.parentElement.insertAdjacentHTML("beforeend",r)})),s.innerHTML=t,s.parentElement.insertAdjacentHTML("beforeend",e)}_loaded(){this.widget.querySelectorAll(".glsr-spinner").forEach((e=>e.remove())),this.widget.classList.remove(r),this.loading=!1}_loading(){if(this.loading)return;this.loading=!0;this.widget.querySelector(n);this.widget.classList.add(r),this.widget.insertAdjacentHTML("beforeend",'<div class="glsr-spinner"></div>')}_onChange(e){this._applyFilters({[e.target.name]:e.target.value}),!1===this._request()&&e.target.form.submit()}_onChangeCheckbox(e){const t=e.currentTarget;this.inputs.forEach((e=>{t!==e&&(e.checked=!1)}));const r=t.checked?t.value:"";this._applyFilters({filter_by_rating:r}),!1!==this._request()&&e.preventDefault()}_onClear(e){this._clearFilters(),!1!==this._request()&&e.preventDefault()}_onClick(e){const r=e.currentTarget,s=r.classList.contains(t)?"":r.dataset.level;this._applyFilters({filter_by_rating:s}),!1!==this._request()&&e.preventDefault()}_onPopstate(e){if(this.id!==e.state.id||!e.state.url)return;const t=new URL(e.state.url);this._syncFilters(Object.fromEntries(t.searchParams)),!1===this._request()&&location.reload()}_onSubmit(e){e.target.search_for&&this._applyFilters({search_for:e.target.search_for.value}),!1!==this._request()&&e.preventDefault()}_removePagination(){const e=this.widget.querySelector(i);e&&e.remove()}_removeStatus(){this.forms.forEach((e=>{const t=e.parentElement.querySelector(o);t&&t.remove()}))}_request(){const e=this._data();return!!e&&(this._loading(),GLSR.ajax.post(e,this._handleResponse.bind(this,e)))}_syncFilters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(const[r,s]of Object.entries(e))"filter_by_rating"===r&&(this.bars.forEach((e=>{const r=s!==e.dataset.level?"remove":"add";e.classList[r](t)})),this.inputs.forEach((e=>{e.checked=s===e.value}))),this.forms.forEach((e=>{e.elements[r]&&(e[r].value=s)}))}_updateUrl(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=Object.entries(t),s=new URL(location.href),i={id:this.id,url:location.href};if(r.length)for(const[t,i]of r)~e.allowed.indexOf(t)&&(""===i?s.searchParams.delete(t):s.searchParams.set(t,i));else e.allowed.forEach((e=>s.searchParams.delete(e)));GLSR.urlparameter&&s.searchParams.delete(GLSR.urlparameter),s.href!==location.href&&history.pushState(i,"",s.href)}};const l="site-reviews-filters",c=GLSR.addons[l],h="a.glsr-bar-filter",u="form.glsr-filters-form",f='.glsr-bar input[type="checkbox"]',d='.glsr[data-shortcode="site_reviews"]',v='.glsr[data-shortcode="site_reviews_filters"]',g='.glsr[data-shortcode="site_reviews_summary"]';GLSR.Event.on(l+"/init",(()=>{const e={};document.querySelectorAll(d).forEach((t=>{const r=t.id,s=[],i=[],n=[];t.querySelectorAll(u).forEach((e=>i.push(e))),document.querySelectorAll(v+","+g).forEach((e=>{const t=e.dataset.reviews_id;t&&r!==t||(e.querySelectorAll(h).forEach((e=>s.push(e))),e.querySelectorAll(u).forEach((e=>i.push(e))),e.querySelectorAll(f).forEach((e=>n.push(e))))})),(s.length||i.length||n.length)&&(e[r]={bars:s,forms:i,id:r,inputs:n,widget:t})})),document.querySelectorAll(v).forEach((e=>{const t=e.dataset.reviews_id;t&&document.querySelector("#"+t+d)||e.querySelectorAll("select").forEach((e=>{e.setAttribute("onchange","this.form.submit()")}))})),c.filters.forEach((e=>e.destroy())),c.filters=[],Object.values(e).forEach((e=>c.filters.push(new a(e))))})),GLSR.Event.on("site-reviews/init",(()=>{GLSR.Event.trigger(l+"/init")}))},239:function(){},873:function(){},524:function(){}},r={};function s(e){var i=r[e];if(void 0!==i)return i.exports;var n=r[e]={exports:{}};return t[e](n,n.exports,s),n.exports}s.m=t,e=[],s.O=function(t,r,i,n){if(!r){var o=1/0;for(h=0;h<e.length;h++){r=e[h][0],i=e[h][1],n=e[h][2];for(var a=!0,l=0;l<r.length;l++)(!1&n||o>=n)&&Object.keys(s.O).every((function(e){return s.O[e](r[l])}))?r.splice(l--,1):(a=!1,n<o&&(o=n));if(a){e.splice(h--,1);var c=i();void 0!==c&&(t=c)}}return t}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[r,i,n]},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={475:0,18:0,879:0,35:0};s.O.j=function(t){return 0===e[t]};var t=function(t,r){var i,n,o=r[0],a=r[1],l=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);if(l)var h=l(s)}for(t&&t(r);c<o.length;c++)n=o[c],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(h)},r=self.webpackChunk=self.webpackChunk||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),s.O(void 0,[18,879,35],(function(){return s(900)})),s.O(void 0,[18,879,35],(function(){return s(239)})),s.O(void 0,[18,879,35],(function(){return s(873)}));var i=s.O(void 0,[18,879,35],(function(){return s(524)}));i=s.O(i)}();